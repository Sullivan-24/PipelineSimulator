labels = {
    "OctoPipe": "OctoPipe",
    "Interleaved": "Interleaved",
    "ZBV": "ZBV",
    "ZBH": "ZBH",
    "ZB": "ZB",
    "Dapple": "Dapple",
    "Naive": "Naive",
    "S-1F1B": "S-1F1B",
    "I-1F1B": "I-1F1B",
    "Mist": "Mist",
}

hatches = {
    "OctoPipe": "//",
    "Interleaved": "+",
    "ZBV": "x",
    "ZBH": "/",
    "ZB": "x",
    "Dapple": ".",
    "S-1F1B": ".",
    "I-1F1B": "\\\\",
    "Naive": ".",
    "Alpa": "+",
    "Mist": "+",
    "Metis": "//",
}

heter_labels = {
    "OctoPipe": "OctoPipe",
    "Alpa": "Alpa",
    "Mist": "Mist",
    "Metis": "Metis",
    "Dapple": "Dapple",
    "Naive": "Naive",
    "S-1F1B": "S-1F1B",
    "I-1F1B": "I-1F1B",
}

markers = {
    "OctoPipe": "D",
    "I-1F1B": "o",
    "ZB": "o",
    "S-1F1B": "o",
    "Metis": "o",
    "Alpa": "o",
    "Mist": "o",
}

colors = {
    "OctoPipe": "#E54C5E",
    "I-1F1B": "#E1D5E7",
    "ZBV": "#FFE6CC",
    "ZBH": "#D5E8D4",
    "ZB": "#4A90E2",
    "S-1F1B": "#ffde82",
    "Metis": "#99CCFF",
    "Alpa": "#48BEA3",
    "Mist": "#48BEA3",
}

# line_colors = {
#     "OctoPipe": "#E54C5E",
#     "I-1F1B": "#E1D5E7",
#     "ZB": "#4A90E2",
#     "S-1F1B": "#ffde82",
#     "Metis": "#99CCFF",
#     "Mist": "#48BEA3",
# }
line_colors = {
    "OctoPipe": "#D64550",   # 鲜红
    "I-1F1B":   "#8B6FAF",   # 中紫
    "ZB":       "#2F6DB2",   # 明亮深蓝
    "S-1F1B":   "#E6A73C",   # 金橙
    "Metis":    "#4A86E8",   # 亮蓝
    "Mist":     "#2FA68C",   # 亮青绿
}

model_heter_4_stage = {
    "Gemma" : {
        "2K":{
            "fwd": [0.030979193173922025, 0.030027713094438826, 0.03018945058186849, 0.05832540988922119],
            "bwd": [0.06091987169705904, 0.05745237214224679, 0.05634080568949382, 0.07649827003479004],
            "mem": [36.2285, 26.8379, 22.8945, 29.0117],
        },
        "4K":{
            "fwd": [0.048637921993549056, 0.04729163646697998, 0.04735566775004069, 0.09939318895339966],
            "bwd": [0.0927570049579327, 0.08960611479622978, 0.08855722745259603, 0.12593291699886322],
            "mem": [52.3594, 38.9863, 31.1211, 37.8848],
        }
    },
    # "DeepSeek-V2-RS" : {
    #     "2K":{
    #         "fwd": [0.02848052978515625, 0.06712150573730469, 0.06682658195495605, 0.10119485855102539],
    #         "bwd": [0.053653717041015625, 0.08961176872253418, 0.09766578674316406, 0.12091898918151855],
    #         "mem": [21.8613, 17.3262, 17.3262, 20.4902]
    #     },
    #     "4K":{
    #         "fwd": [0.04205322265625, 0.1081399917602539, 0.10775518417358398, 0.1421959400177002],
    #         "bwd": [0.08239436149597168, 0.15581035614013672, 0.14588403701782227, 0.17009544372558594],
    #         "mem": [32.3164, 29.4632, 27.2215, 28.6402]
    #     }
    # },
    
    "LLaMA3-VF" : {
        "2K":{
            "fwd": [0.022709369659423828, 0.025893211364746094, 0.029953343527657644, 0.05251419544219971],
            "bwd": [0.04073381423950195, 0.045702497164408364, 0.05459431239536831, 0.08169332146644592],
            "mem": [16.8223, 15.7773, 19.0879, 26.7344],
        },
        "4K":{
            "fwd": [0.029047727584838867, 0.036360979080200195, 0.04280996322631836, 0.0858004093170166],
            "bwd": [0.056850433349609375, 0.06891822814941406, 0.0832068920135498, 0.12211060523986816],
            "mem": [22.1387, 21.6699, 24.9531, 33.625],
        }
    },
    "DeepSeek-RS" : {
        "2K": {
            "fwd": [0.018987019856770833, 0.04474767049153646, 0.044551054636637366, 0.06746323903401693],
            "bwd": [0.03576914469401042, 0.05974117914835612, 0.0651105244954427, 0.08061265945435696],
            "mem": [21.8613, 17.3262, 17.3262, 20.4902]
        },
        "4K": {
            "fwd": [0.028035481770833332, 0.07209332784016927, 0.07183678944905598, 0.09479729334513347],
            "bwd": [0.05492957433064779, 0.10387357076009115, 0.0972560246785482, 0.11339696248372395],
            "mem": [32.3164, 29.4632, 27.2215, 28.6402]
        }
    },
}

layer_overhead = {
    "Megatron":{
        "F" : {
            "Transformer layer":(21.684+21.225+21.458+22.449) / 4,
            "+ Non-transformer layer": (58.342+59.566+58.005+60.162) / 4,
        },
        "B" : {
            "Transformer layer":(45.983+45.057+46.229+45.409) / 4,
            "+ Non-transformer layer": (78.800+76.587+77.652+74.893) / 4,
        },
    },
    "Backward-splitting":{
        "F" : {
            "Transformer layer":(20.998+20.882+20.518+21.359) / 4,
            "+ Non-transformer layer": (56.983+57.393+57.195+57.078) / 4,
        },
        "B" : {
            "Transformer layer":(26.997+28.427+27.338+27.372) / 4,
            "+ Non-transformer layer": (45.929+45.768+45.422+46.298) / 4,
        },
        "W" : {
            "Transformer layer":(18.869+18.340+18.879+18.341) / 4,
            "+ Non-transformer layer": (33.906+32.943+33.697+33.066) / 4,
        },
    },
}

preprocessing = {
    "70B": {
        # "pp2":{
        #     "single":13.459882974624634/5,
        #     "multi":13.459882974624634/5,
        # },
        "pp4":{
            "single":39.11562919616699/5,
            "multi":39.11562919616699/5,
        },
        "pp8":{
            "single":114.67990231513977/5,
            "multi":114.67990231513977/5,
        },
        "pp10":{
            "single": 56.93681597709656,
            "multi": 56.93681597709656,
        },
        "pp16":{
            "single": 779.8600070476532/5,
            "multi": 779.8600070476532/5,
        },
        "pp20":{
            "single": 224.93572807312012,
            "multi": 224.93572807312012,
        },
        "pp40":{
            "single": 1045.2018249034882,
            "multi": 1045.2018249034882,
        },
    },
    "42B": {
        # "pp2":{
        #     "single":5.076202869415283/5,
        #     "multi":5.076202869415283/5,
        # },
        "pp4":{
            "single":17.601519107818604/5,
            "multi":17.601519107818604/5,
        },
        "pp8":{
            "single":67.80011010169983/5,
            "multi":67.80011010169983/5,
        },
        "pp12":{
            "single":158.8371820449829/5,
            "multi":158.8371820449829/5,
        },
        "pp16":{
            "single":301.7992088794708/5,
            "multi":301.7992088794708/5,
        },
        "pp24":{
            "single":133.84632897377014,
            "multi":133.84632897377014,
        }
    },
    "14B": {
        # "pp2":{
        #     "single":0.756459712982177/5,
        #     "multi":0.756459712982177/5,
        # },
        "pp4":{
            "single":2.7287838459014893/5,
            "multi":2.7287838459014893/5,
        },
        "pp8":{
            "single":12.119674921035767/5,
            "multi":12.119674921035767/5,
        },
        "pp16":{
            "single":45.608559131622314/5,
            "multi":45.608559131622314/5,
        },
    }
}

comp_data = {
    "56B LLaMA": {
         "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 535,
                "Interleaved": 512,
                "ZBV": 526,
                "ZBH": 506,
                "Dapple": 478,
            },
            "heter":{
                "OctoPipe": 275,
                "Interleaved": 158,
                "ZBV": 255,
                "ZBH": 225,
                "Dapple": 238,
            },
        },
        "pp4 tp8 dp1 mb16":{
            "heter":{
                "OctoPipe": 184,
                "Interleaved": 79,
                "ZBV": 128,
                "ZBH": 114,
                "Dapple": 118,
            },
            "homo":{
                "OctoPipe": 450,
                "Interleaved": 433,
                "ZBV": 420,
                "ZBH": 410,
                "Dapple": 400,
            },
        },
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 490,
                "Interleaved": 475,
                "ZBV": 495,
                "ZBH": 475,
                "Dapple": 435,
            },
            "heter":{
                "OctoPipe": 168,
                "Interleaved": 81,
                "ZBV": 134,
                "ZBH": 115,
                "Dapple": 120,
            },
        },
    },
    "70B LLaMA": {
        "pp4 tp4 dp4 mb16":{
            "homo":{
                "OctoPipe": 415,
                "Interleaved": 399,
                "ZBV": 400,
                "ZBH": 390,
                "Dapple": 370,
            },
            "heter":{
            },
        },
        "pp4 tp8 dp2 mb16":{
            "homo":{
                "OctoPipe": 334,
                "Interleaved": 318,
                "ZBV": 307,
                "ZBH": 305,
                "Dapple": 295,
            },
            "heter":{
            },
        },
        "pp8 tp4 dp2 mb32":{
            "homo":{
                "OctoPipe": 414,
                "Interleaved": 390,
                "ZBV": 404,
                "ZBH": 386,
                "Dapple": 356,
            },
            "heter":{
            },
        },
        # "pp8 tp8 dp1 mb32":{
        #     "homo":{
        #         "OctoPipe": 348,
        #         "Interleaved": 328,
        #         "ZBV": 330,
        #         "ZBH": 316,
        #         "Dapple": 300,
        #     },
        #     "heter":{
        #     },
        # },
    },
}

data_h800_heter = {
    "70B LLaMA": {
        "pp8 tp4 dp1 mb32":{
            "OctoPipe": 390,
            "Alpa": 0,
            "Metis": 0,
            "Dapple": 324,
        },
        "pp4 tp8 dp1 mb16":{
            "OctoPipe": 390,
            "Alpa": 338,
            "Metis": 340,
            "Dapple": 259,
        },
    },
    "42B LLaMA": {
        "pp8 tp4 dp1 mb32":{
            "OctoPipe": 518,
            "Alpa": 472,
            "Metis": 446,
            "Dapple": 363,
        },
        "pp4 tp8 dp1 mb16":{
            "OctoPipe": 655,
            "Alpa": 625,
            "Metis": 505,
            "Dapple": 445,
        },
    },
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "OctoPipe": 2965,
            "Alpa": 2156,
            "Metis": 0,
            "Dapple": 1655,
        },
        "pp4 tp2 dp1 mb16":{
            "OctoPipe": 2965,
            "Alpa": 2120,
            "Metis": 2037,
            "Dapple": 1752,
        },
    },
}

data_h800 = {
    "70B LLaMA": {
         "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 761,
                "Interleaved": 200,
                "ZBV": 0,
                "ZBH": 0,
                "Dapple": 670,
            },
            "heter":{
                "OctoPipe": 8563,
                "Interleaved": 0, #13298,
                "ZBV": 0, #13072,
                "ZBH": 0, #13072,
                "Dapple": 14018,
            },
        },
        "pp4 tp8 dp1 mb16":{
            "homo":{
                "OctoPipe": 599,
                "Interleaved": 565,
                "ZBV": 534,
                "ZBH": 553,
                "Dapple": 540,
            },
            "heter":{
                "OctoPipe": 8473,
                "Interleaved": 13298,
                "ZBV": 12072,
                "ZBH": 13172,
                "Dapple": 13018,
            },
        },
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 810,
                "Interleaved": 400,
                "ZBV": 775,
                "ZBH": 750,
                "Dapple": 720,
            },
            "heter":{
                "OctoPipe": 8964,
                "Interleaved": 0, #14534,
                "ZBV": 12632,
                "ZBH": 14232,
                "Dapple": 15134,
            },
        },
    },
    "42B LLaMA": {
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 1260,
                "Interleaved": 1207,
                "ZBV": 1040,
                "ZBH": 1180,
                "Dapple": 1128,
            },
            "heter":{
                "OctoPipe": 5528,
                "Interleaved": 9566,
                "ZBV": 9384,
                "ZBH": 9584,
                "Dapple": 10106,
            },
        },
        "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 1375,
                "Interleaved": 1325,
                "ZBV": 1275,
                "ZBH": 1270,
                "Dapple": 1226,
            },
            "heter":{
                "OctoPipe": 5222,
                "Interleaved": 8462,
                "ZBV": 8440,
                "ZBH": 8240,
                "Dapple": 10506,
            },
        },
        "pp4 tp8 dp1 mb16":{
            "homo":{
                "OctoPipe": 955,
                "Interleaved": 920,
                "ZBV": 855,
                "ZBH": 890,
                "Dapple": 843,
            },
            "heter":{
                "OctoPipe": 5222,
                "Interleaved": 8202,
                "ZBV": 8340,
                "ZBH": 8240,
                "Dapple": 10306,
            },
        },
        "pp4 tp4 dp1 mb16":{
            "homo":{
                "OctoPipe": 1309,
                "Interleaved": 1257,
                "ZBV": 1271,
                "ZBH": 1240,
                "Dapple": 1195,
            },
            "heter":{
                "OctoPipe": 5525,
                "Interleaved": 8502,
                "ZBV": 8640,
                "ZBH": 8240,
                "Dapple": 10806,
            },
        },
        "pp8 tp2 dp1 mb32":{
            "homo":{
                "OctoPipe": 1395,
                "Interleaved": 0,
                "ZBV": 0,
                "ZBH": 0,
                "Dapple": 1334,
            },
            "heter":{
                "OctoPipe": 5528,
                "Interleaved": 0,
                "ZBV": 0,
                "ZBH": 0,
                "Dapple": 10156,
            },
        },
    },
    "14B LLaMA": {
        "pp4 tp2 dp1 mb16":{
            "homo":{
                "OctoPipe": 3776,
                "Interleaved": 3593,
                "ZBV": 3515,
                "ZBH": 3584,
                "Dapple": 3375,
            },
            "heter":{
                "OctoPipe": 2175,
                "Interleaved": 3506,
                "ZBV": 3456,
                "ZBH": 3456,
                "Dapple": 3650,
            },
        },
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "OctoPipe": 3455,
                "Interleaved": 3262,
                "ZBV": 0,
                "ZBH": 3288,
                "Dapple": 3130,
            },
            "heter":{
                "OctoPipe": 2535,
                "Interleaved": 0, #4598,
                "ZBV": 0, #4536,
                "ZBH": 0, #4536,
                "Dapple": 4778,
            },
        },
    },
}


ablation_study_data = {
    "70B LLaMA": {
         "pp4 tp4 dp2 mb16":{
            "homo":{
                "+ Overlap-aware": 761,
                "+ Memory monitor": 741,
                "+ Adaptive workload schedule": 742,
                "+ Adaptive model placement": 718,
                "Dapple": 670,
            },
            "heter":{
            },
        },
    },
    "42B LLaMA": {
        "pp4 tp8 dp1 mb16":{
            "homo":{
                "+ Overlap-aware": 950,
                "+ Memory monitor": 922,
                "+ Adaptive workload schedule": 921,
                "+ Adaptive model placement": 841,
                "Dapple": 745,
            },
            "heter":{
            },
        },
    },
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "+ Overlap-aware": 3402,
                "+ Memory monitor": 3356,
                "+ Adaptive workload schedule": 0,
                "+ Adaptive model placement": 3301,
                "Dapple": 3124,
            },
            "heter":{
            },
        },
    },
}

sim = {
    "56B LLaMA": {
         "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 1624,
                "Interleaved": 1760,
                "ZBV": 1663,
                "ZBH": 1712,
                "Dapple": 1904,
            },
            "heter":{
            },
        },
        "pp4 tp8 dp1 mb16":{
            "heter":{
            },
            "homo":{
                "OctoPipe": 1624,
                "Interleaved": 1760,
                "ZBV": 1663,
                "ZBH": 1712,
                "Dapple": 1904,
            },
        },
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 1744,
                "Interleaved": 1864,
                "ZBV": 1751,
                "ZBH": 1808,
                "Dapple": 2032,
            },
        },
    },
    "70B LLaMA": {
        "pp4 tp4 dp4 mb16":{
            "homo":{
                "OctoPipe": 2039,
                "Interleaved": 2180,
                "ZBV": 2059,
                "ZBH": 2120,
                "Dapple": 2360,
            },
            "heter":{
            },
        },
        "pp4 tp8 dp2 mb16":{
            "homo":{
                "OctoPipe": 2039,
                "Interleaved": 2180,
                "ZBV": 2059,
                "ZBH": 2120,
                "Dapple": 2360,
            },
            "heter":{
            },
        },
        "pp8 tp4 dp2 mb32":{
            "homo":{
                "OctoPipe": 2122,
                "Interleaved": 2290,
                "ZBV": 2149,
                "ZBH": 2220,
                "Dapple": 2500,
            },
            "heter":{
            },
        },
    },
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "OctoPipe": 2332,
                "Interleaved": 2386,
                "ZBV": 2283,
                "ZBH": 2292,
                "Dapple": 2462,
            },
            "heter":{
            },
        },
        "pp4 tp2 dp1 mb16":{
            "homo":{
                "OctoPipe": 1698,
                "Interleaved": 1796,
                "ZBV": 1726,
                "ZBH": 1746,
                "Dapple": 1898,
            },
            "heter":{
            },
        },
    },
}

sim_h800 = {
    "70B LLaMA": {
        "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 6383,
                "Interleaved": 6836,
                "ZBV": 6454,
                "ZBH": 6738,
                "Dapple": 7370,
            },
            "heter":{
            },
        },
        "pp4 tp8 dp1 mb16":{
            "homo":{
                "OctoPipe": 5802,
                "Interleaved": 6300,
                "ZBV": 6454,
                "ZBH": 6120,
                "Dapple": 6840,
            },
            "heter":{
            },
        },
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 2122,
                "Interleaved": 8332,
                "ZBV": 7031,
                "ZBH": 7314,
                "Dapple": 8078,
            },
            "heter":{
            },
        },
    },
    "42B LLaMA": {
        "pp4 tp4 dp1 mb16":{
            "homo":{
                "OctoPipe": 4002,
                "Interleaved": 4316,
                "ZBV": 4090,
                "ZBH": 4242,
                "Dapple": 4634,
            },
            "heter":{
            },
        },
        "pp4 tp4 dp2 mb16":{
            "homo":{
                "OctoPipe": 4002,
                "Interleaved": 4316,
                "ZBV": 4090,
                "ZBH": 4242,
                "Dapple": 4634,
            },
            "heter":{
            },
        },
        "pp4 tp8 dp1 mb16":{
            "homo":{
                "OctoPipe": 4002,
                "Interleaved": 4316,
                "ZBV": 4090,
                "ZBH": 4242,
                "Dapple": 4634,
            },
            "heter":{
            },
        },
        "pp8 tp4 dp1 mb32":{
            "homo":{
                "OctoPipe": 4554,
                "Interleaved": 4620,
                "ZBV": 4657,
                "ZBH": 4786,
                "Dapple": 5270,
            },
            "heter":{
            },
        },
    },
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "OctoPipe": 2252,
                "Interleaved": 2386,
                "ZBV": 2283,
                "ZBH": 2292,
                "Dapple": 2462,
            },
            "heter":{
            },
        },
        "pp4 tp2 dp1 mb16":{
            "homo":{
                "OctoPipe": 1698,
                "Interleaved": 1796,
                "ZBV": 1726,
                "ZBH": 1746,
                "Dapple": 1898,
            },
            "heter":{
            },
        },
    },
}

mem_pro_h800 = {
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "OctoPipe": [66.4321, 49.3999, 49.1665, 48.0542, 46.8794, 45.813, 44.7632, 68.9313 - 5], #TODO runtime wrong order
                "Interleaved": [66.103, 47.5874, 45.2378, 42.8882, 40.5386, 38.189, 35.8394, 52.5878],
                # "ZBV": ["OOM","OOM","OOM","OOM","OOM","OOM","OOM","OOM"],
                "ZBH": [56.7446, 41.4009, 41.1216, 40.8423, 40.563, 40.2837, 40.0044, 66.2174],
                "Dapple": [56.7446, 38.8638, 36.5767, 34.2896, 32.0025, 29.7153, 27.7252, 47.2957],
            },
            "heter":{
            },
        },
    },
}
mem_sim_h800 = {
    "14B LLaMA": {
        "pp8 tp1 dp1 mb32":{
            "homo":{
                "OctoPipe": [67.042, 49.749, 49.459, 48.35, 47.24, 46.421, 45.311, 62.975],
                "Interleaved": [65.296, 47.421, 45.202, 42.984, 40.765, 38.547, 36.328, 53.18],
                # "ZBV": [79.841, 44.093, 44.093, 44.093, 45.202, 45.202, 46.311, 46.311],
                "ZBH": [59.346, 43.732, 43.153, 42.573, 41.994, 41.415, 40.836, 67.698],
                "Dapple": [57.531, 39.656, 37.437, 35.219, 33.0, 30.781, 28.563, 45.852],
            },
            "heter":{
            },
        },
    },
}
vary_seq = {
    "OctoPipe": [1752, 2345, 2582, 2630, 2596],
    "ZBH": [1772, 2304, 2489, 2530, 2490],
    "Dapple": [1730, 2250, 2450, 2445, 2430],
}

ablation_data = {
    "Gemma":{
        "Baseline": 1/1.3243,
        "1": 1/1.3936,
        "2": 1/1.2870,
        "3": 1/1.1330,
        # "3": 1/1.0930,
        "1+2": 1/1.0846,
        "1+3": 1/1.0557,
        "2+3": 1/1.0458,
        "1+2+3": 1,
    },
    "DeepSeek":{
        "Baseline": 1/1.3684,
        "1": 1/1.3413,
        "2": 1/1.3429,
        "3": 1/1.1841,
        "1+2": 1/1.1286,
        "1+3": 1/1.0536,
        "2+3": 1/1.1004,
        "1+2+3": 1,
    },
    "Nemotron-H":{
        "Baseline": 1/1.3286,
        "1": 1/1.5902,
        "2": 1/1.3165,
        "3": 1/1.1879,
        "1+2": 1/1.4215,
        "1+3": 1/1.0836,
        "2+3": 1/1.0912,
        "1+2+3": 1,
    },
}

h200_data = {
    "Gemma": {
        "Seq_2k": {
            "32,256": {
                "S-1F1B": 4421,
                "I-1F1B": 4395,
                "ZB": 4368,
                "Mist": 4507,
                "OctoPipe": 5086
            },
            "64,512": {
                "S-1F1B": 1769,
                "I-1F1B": 1745,
                "ZB": 1764,
                "Mist": 2075,
                "OctoPipe": 2320
            },
            "128,1024": {
                "S-1F1B": 647,
                "I-1F1B": 621,
                "ZB": 667,
                "Mist": 799,
                "OctoPipe": 890
            }
        },
        "Seq_4k": {
            "32,256": {
                "S-1F1B": 6209,
                "I-1F1B": 6325,
                "ZB": 6364,
                "Mist": 7048,
                "OctoPipe": 7566
            },
            "64,512": {
                "S-1F1B": 2266,
                "I-1F1B": 2306,
                "ZB": 2343,
                "Mist": 2782,
                "OctoPipe": 3015
            },
            "128,1024": {
                "S-1F1B": 861,
                "I-1F1B": 731,
                "ZB": 885,
                "Mist": 1093,
                "OctoPipe": 1226
            }
        }
    },
    "DeepSeek": {
        "Seq_2k": {
            "16,128": {
                "S-1F1B": 8697,
                "I-1F1B": 8706,
                "ZB": 8856,
                "Mist": 9583,
                "OctoPipe": 11044
            },
            "32,256": {
                "S-1F1B": 3495,
                "I-1F1B": 3399,
                "ZB": 3456,
                "Mist": 3870,
                "OctoPipe": 4730
            },
            "64,512": {
                "S-1F1B": 1811,
                "I-1F1B": 1745,
                "ZB": 1847,
                "Mist": 2304,
                "OctoPipe": 2482
            }
        },
        "Seq_4k": {
            "16,128": {
                "S-1F1B": 12031,
                "I-1F1B": 12463,
                "ZB": 12152,
                "Mist": 12921,
                "OctoPipe": 15719
            },
            "32,256": {
                "S-1F1B": 4339,
                "I-1F1B": 4534,
                "ZB": 4450,
                "Mist": 5280,
                "OctoPipe": 5935
            },
            "64,512": {
                "S-1F1B": 2089,
                "I-1F1B": 2056,
                "ZB": 2133,
                "Mist": 2467,
                "OctoPipe": 2989
            }
        }
    },
    "Nemotron-H": {
        "Seq_2k": {
            "28,128": {
                "S-1F1B": 7586,
                "I-1F1B": 7128,
                "ZB": 7355,
                "Mist": 7557,
                "OctoPipe": 8945
            },
            "56,256": {
                "S-1F1B": 3499,
                "I-1F1B": 3109,
                "ZB": 3517,
                "Mist": 4067,
                "OctoPipe": 4943
            },
            "112,512": {
                "S-1F1B": 1439,
                "I-1F1B": 1157,
                "ZB": 1403,
                "Mist": 1691,
                "OctoPipe": 1940
            }
        },
        "Seq_4k": {
            "28,128": {
                "S-1F1B": 13244,
                "I-1F1B": 12082,
                "ZB": 13040,
                "Mist": 14879,
                "OctoPipe": 16696
            },
            "56,256": {
                "S-1F1B": 5414,
                "I-1F1B": 4502,
                "ZB": 5454,
                "Mist": 5831,
                "OctoPipe": 7381
            },
            "112,512": {
                "S-1F1B": 1946,
                "I-1F1B": 1515,
                "ZB": 2014,
                "Mist": 2254,
                "OctoPipe": 2650
            }
        }
    }
}

solving_time = {
    "S":{
        "ILP Solver 1":{
            1 : 0.01,
            2 : 0.01,
            3 : 0.01,
            4 : 0.02,
            5 : 0.05,
            6 : 0.20,
            7 : 0.40,
            8 : 2.31,
            9 : 9.38,
            10 : 23.92,
            11 : 91.12,
            12 : 567.09,
            # 11 : 218.22,
            # 12:708.45,
        },
        "ILP Solver 1+2":{
            1 : 0.03,
            2 : 0.16,
            3 : 0.65,
            4 : 2.49,
            5 : 6.01,
            6 : 16.60,
            7 : 37.38,
            8 : 286.79,
            9 : 655.44,
            10 : 4980.70,
            # 9:1.73,
            # 10:6.51,
            # 11:91.12,
            # 12:708.45,
            # 16:708.45 * 4**4,
            # 32:708.45 * 4**20,
            # 64:708.45 * 4**52,
            # 128:708.45 * 4**116,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 0.01,
            2 : 2.48,
            3 : 25.07,
            4 : 3225.21,
        },
        "OctoPipe 1+2+3":{
            1:0.0027229785919189453,
            2:0.004370212554931641,
            # 3:0.006058931350708008,
            4:0.007737159729003906,
            # 5:0.010064125061035156,
            8:0.016314029693603516,
            # 10:0.021142005920410156,
            # 11:0.02317976951599121,
            # 12:0.02660202980041504,
            16:0.0471949577331543,
            32:0.1510000228881836,
            64:0.5599300861358643,
            128:2.147493839263916,
            256:8.570109844207764,
        },
        "ILP Solver (Simple)":{
            1 : 0.01,
            2 : 0.01,
            3 : 0.01,
            4 : 0.02,
            5 : 0.05,
            6 : 0.20,
            7 : 0.40,
            8 : 2.31,
            9 : 9.38,
            10 : 23.92,
            11 : 91.12,
            12 : 567.09,
        },
        "ILP Solver":{
            1 : 0.03,
            2 : 0.16,
            3 : 0.65,
            4 : 2.49,
            5 : 6.01,
            6 : 16.60,
            7 : 37.38,
            8 : 286.79,
            9 : 655.44,
            10 : 4980.70,
        },
        "OctoPipe":{
            1:0.0027229785919189453,
            2:0.004370212554931641,
            # 3:0.006058931350708008,
            4:0.007737159729003906,
            # 5:0.010064125061035156,
            8:0.016314029693603516,
            # 10:0.021142005920410156,
            # 11:0.02317976951599121,
            # 12:0.02660202980041504,
            16:0.0471949577331543,
            32:0.1510000228881836,
            64:0.5599300861358643,
            128:2.147493839263916,
            256:8.570109844207764,
        }
    },
    "M":{
        "ILP Solver 1":{
            1 : 0.01,
            2 : 0.02,
            3 : 0.03,
            4 : 0.04,
            5 : 0.20,
            6 : 0.39,
            7 : 1.60,
            8 : 3.33,
            9 : 14.37,
            10 : 54.16,
            11 : 139.95,
            12 : 1149.01,
            # 16:708.45 * 8**4,
            # 32:708.45 * 8**20,
            # 64:708.45 * 8**52,
            # 128:708.45 * 8**116,
        },
        "ILP Solver 1+2":{
            1:0.08,
            2:1.74,
            3:13.55,
            4:42.50,
            5:123.28,
            6:334.71,
            7:2570.85,
            # 8:,
            # 9:,
            # 10:,
            # 11:,
            # 12:708.45,
            # 16:708.45 * 4**4,
            # 32:708.45 * 4**20,
            # 64:708.45 * 4**52,
            # 128:708.45 * 4**116,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 0.01,
            2 : 12.48,
            3 : 255.07,
            4 : 33225.21,
        },
        "OctoPipe 1+2+3":{
            1:0.010091066360473633,
            2:0.016767024993896484,
            4:0.030283212661743164,
            8:0.06046891212463379,
            # 12:0.10080623626708984,
            16:0.14447903633117676,
            32:0.46828699111938477,
            64:1.6417560577392578,
            128:6.35432505607605,
            256:24.684877157211304,
        },
        "ILP Solver (Simple)":{
            1 : 0.01,
            2 : 0.02,
            3 : 0.03,
            4 : 0.04,
            5 : 0.20,
            6 : 0.39,
            7 : 1.60,
            8 : 3.33,
            9 : 14.37,
            10 : 54.16,
            11 : 139.95,
            12 : 1149.01,
        },
        "ILP Solver":{
            1:0.08,
            2:1.74,
            3:13.55,
            4:42.50,
            5:123.28,
            6:334.71,
            7:2570.85,
        },
        "OctoPipe":{
            1:0.010091066360473633,
            2:0.016767024993896484,
            4:0.030283212661743164,
            8:0.06046891212463379,
            # 12:0.10080623626708984,
            16:0.14447903633117676,
            32:0.46828699111938477,
            64:1.6417560577392578,
            128:6.35432505607605,
            256:24.684877157211304,
        }
    },
    "L":{
        "ILP Solver 1":{
            1 : 0.02,
            2 : 1.06,
            3 : 4.23,
            4 : 63.23,
        },
        "ILP Solver 1+2":{
            1 : 0.02,
            2 : 6.06,
            3 : 38.23,
            4 : 4559.98,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 10.01,
            2 : 152.48,
            3 : 1315.07,
            4 : 113211.21,
        },
        "OctoPipe 1+2+3":{
            1 : 0.04270195960998535,
            2 : 0.06787681579589844,
            4 : 0.12933897972106934,
            8 : 0.28123903274536133,
            16 : 0.7080039978027344,
            32 : 2.0303170680999756,
            64 : 6.652433156967163,
            128 : 23.73698091506958,
            256 : 92.29179000854492,
        },
        "ILP Solver (Simple)":{
            1 : 0.02,
            2 : 1.06,
            3 : 4.23,
            4 : 63.23,
        },
        "ILP Solver":{
            1 : 0.02,
            2 : 6.06,
            3 : 38.23,
            4 : 4559.98,
        },
        "OctoPipe":{
            1 : 0.04270195960998535,
            2 : 0.06787681579589844,
            4 : 0.12933897972106934,
            8 : 0.28123903274536133,
            16 : 0.7080039978027344,
            32 : 2.0303170680999756,
            64 : 6.652433156967163,
            128 : 23.73698091506958,
            256 : 92.29179000854492,
        }
    },
}

vary_length_seqence = {
    "1k": {
        "S-1F1B": 676,
        "I-1F1B": 493,
        "ZB": 630,
        "Mist": 632,
        "OctoPipe": 757
    },
    "2k": {
        "S-1F1B": 1253,
        "I-1F1B": 967,
        "ZB": 1261,
        "Mist": 1345,
        "OctoPipe": 1531
    },
    "4k": {
        "S-1F1B": 2244,
        "I-1F1B": 1758,
        "ZB": 2242,
        "Mist": 2487,
        "OctoPipe": 2810
    },
    "8k": {
        "S-1F1B": 3640,
        "I-1F1B": 2800,
        "ZB": 3704,
        "Mist": 4608,
        "OctoPipe": 5592
    },
    "16k": {
        "S-1F1B": 5090,
        "I-1F1B": 4152,
        "ZB": 5179,
        "Mist": 6965,
        "OctoPipe": 7670
    },
    "32k": {
        "S-1F1B": 5428,
        "I-1F1B": 4070,
        "ZB": 5521,
        "Mist": 7353,
        "OctoPipe": 8198
    }
}

strong_scaling_data = {
    # "(8, 8, 1)": {
    "GPU#=8": {
        "S-1F1B": 6153 * 8,
        "I-1F1B": 5772 * 8,
        "ZB": 6212 * 8,
        "Mist": 7958 * 8,
        "OctoPipe": 8190 * 8
    },
    # "(16, 8, 2)": {
    "GPU#=16": {
        "S-1F1B": 5339 * 16,
        "I-1F1B": 4529 * 16,
        "ZB": 5384 * 16,
        "Mist": 6899 * 16,
        "OctoPipe": 7310 * 16
    },
    # "(32, 8, 4)": {
    "GPU#=32": {
        "S-1F1B": 3640 * 32,
        "I-1F1B": 2800 * 32,
        "ZB": 3704 * 32,
        "Mist": 4608 * 32,
        "OctoPipe": 5492 * 32,
    },
}

weak_scaling_data = {
    # "(8, 8, 1)": {
    "GPU#=8": {
        "S-1F1B": 6153 * 8,
        "I-1F1B": 5772 * 8,
        "ZB": 6212 * 8,
        "Mist": 7958 * 8,
        "OctoPipe": 8190 * 8,
    },
    # "(16, 8, 2)": {
    "GPU#=16": {
        "S-1F1B": 5888 * 16,
        "I-1F1B": 5375 * 16,
        "ZB": 6021 * 16,
        "Mist": 7661 * 16,
        "OctoPipe": 8053 * 16,
    },
    # "(32, 8, 4)": {
    "GPU#=32": {
        "S-1F1B": 5508 * 32,
        "I-1F1B": 4933 * 32,
        "ZB": 5560 * 32,
        "Mist": 7250 * 32,
        "OctoPipe": 7918 * 32,
    },
}

profiled_data = {
    "NEMOTRONH":{ # Model
        1024:{ # Hidden
            1024:{ # Sequence length
                131072 : [3.17, 5.17, 0.5, 1.0, 2.54, 0.02, 8.23, 0.12, 0.4],
                262144 : [2.69, 4.45, 0.43, 1.0, 2.46, 0.02, 10.01, 1.28, 0.63],
                524288: [3.38, 5.32, 0.52, 1.0, 2.75, 0.02, 17.1, 2.82, 1.38],
            },
            2048:{
                131072 : [3.38, 5.18, 0.53, 1.0, 2.75, 0.02, 10.81, 0.9, 0.57],
                262144 : [2.79, 4.45, 0.46, 1.0, 2.53, 0.02, 13.92, 2.22, 0.95],
                524288: [3.06, 4.99, 0.5, 1.0, 2.53, 0.02, 24.37, 5.4, 1.96],
            },
            4096:{
                131072 : [3.12, 4.96, 0.52, 1.0, 2.79, 0.02, 13.99, 2.13, 0.86],
                262144 : [3.22, 5.07, 0.54, 1.0, 2.85, 0.02, 23.94, 5.24, 1.71],
                524288: [3.06, 4.96, 0.53, 1.0, 2.7, 0.02, 39.97, 10.33, 3.18],
            },
            8192:{
                131072 : [3.14, 5.26, 0.54, 1.0, 2.85, 0.02, 19.38, 3.53, 1.33],
                262144 : [3.15, 5.32, 0.55, 1.0, 2.8, 0.01, 35.93, 9.04, 2.72],
                524288: [3.17, 5.2, 0.55, 1.0, 2.95, 0.02, 66.15, 18.69, 5.3],
            },
            16384:{
                131072 : [4.74, 7.84, 0.75, 1.0, 3.54, 0.02, 32.48, 6.14, 2.27],
                262144 : [3.95, 7.21, 0.68, 1.0, 3.03, 0.01, 55.09, 14.06, 4.07],
                524288: [3.53, 6.23, 0.61, 1.0, 3.1, 0.02, 97.43, 29.09, 7.8],
            },
            32768:{
                131072 : [4.81, 9.94, 0.65, 1.0, 2.91, 0.01, 35.18, 4.34, 2.54],
                262144 : [4.93, 9.84, 0.66, 1.0, 3.09, 0.0, 68.75, 15.87, 5.23],
                524288: [4.79, 9.49, 0.65, 1.0, 3.25, 0.01, 369.05, 37.76, 10.86],
            },
        }
    }
}