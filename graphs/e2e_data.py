labels = {
    "OctoPipe": "OctoPipe",
    "Interleaved": "Interleaved",
    "ZBV": "ZBV",
    "ZBH": "ZBH",
    "ZB": "ZB",
    "Dapple": "Dapple",
    "Naive": "Naive",
    "S-1F1B": "S-1F1B",
    "I-1F1B": "I-1F1B",
    "Mist": "Mist",
}

hatches = {
    "OctoPipe": "//",
    "Interleaved": "+",
    "ZBV": "x",
    "ZBH": "/",
    "ZB": "x",
    "Dapple": ".",
    "S-1F1B": ".",
    "I-1F1B": "\\\\",
    "Naive": ".",
    "Alpa": "+",
    "Mist": "+",
    "Metis": "//",
}

heter_labels = {
    "OctoPipe": "OctoPipe",
    "Alpa": "Alpa",
    "Mist": "Mist",
    "Metis": "Metis",
    "Dapple": "Dapple",
    "Naive": "Naive",
    "S-1F1B": "S-1F1B",
    "I-1F1B": "I-1F1B",
}

markers = {
    "OctoPipe": "D",
    "I-1F1B": "o",
    "ZB": "o",
    "S-1F1B": "o",
    "Metis": "o",
    "Alpa": "o",
    "Mist": "o",
}

colors = {
    "OctoPipe": "#E54C5E",
    "I-1F1B": "#E1D5E7",
    "ZBV": "#FFE6CC",
    "ZBH": "#D5E8D4",
    "ZB": "#4A90E2",
    "S-1F1B": "#ffde82",
    "Metis": "#99CCFF",
    "Alpa": "#48BEA3",
    "Mist": "#48BEA3",
}

# line_colors = {
#     "OctoPipe": "#E54C5E",
#     "I-1F1B": "#E1D5E7",
#     "ZB": "#4A90E2",
#     "S-1F1B": "#ffde82",
#     "Metis": "#99CCFF",
#     "Mist": "#48BEA3",
# }
line_colors = {
    "OctoPipe": "#D64550",   # 鲜红
    "I-1F1B":   "#8B6FAF",   # 中紫
    "ZB":       "#2F6DB2",   # 明亮深蓝
    "S-1F1B":   "#E6A73C",   # 金橙
    "Metis":    "#4A86E8",   # 亮蓝
    "Mist":     "#2FA68C",   # 亮青绿
}

ablation_data = {
    "Gemma":{
        "Baseline": 1/1.3243,
        "1": 1/1.3936,
        "2": 1/1.2870,
        "3": 1/1.1330,
        # "3": 1/1.0930,
        "1+2": 1/1.0846,
        "1+3": 1/1.0557,
        "2+3": 1/1.0458,
        "1+2+3": 1,
    },
    "DeepSeek":{
        "Baseline": 1/1.3684,
        "1": 1/1.3413,
        "2": 1/1.3429,
        "3": 1/1.1841,
        "1+2": 1/1.1286,
        "1+3": 1/1.0536,
        "2+3": 1/1.1004,
        "1+2+3": 1,
    },
    "Nemotron-H":{
        "Baseline": 1/1.3286,
        "1": 1/1.5902,
        "2": 1/1.3165,
        "3": 1/1.1879,
        "1+2": 1/1.4215,
        "1+3": 1/1.0836,
        "2+3": 1/1.0912,
        "1+2+3": 1,
    },
}

h200_sim_data = { # Time cost
    "Nemotron-H": {
        "Seq_2k": {
            "Small": {
                "S-1F1B": 4534,
                "I-1F1B": 4706,
                "ZB": 4678,
                "Mist": 4429,
                "OctoPipe": 4119,
            },
            "Medium": {
                "S-1F1B": 8319,
                "I-1F1B": 8837,
                "ZB": 8207,
                "Mist": 7350,
                "OctoPipe": 5860,
            },
            "Large": {
                "S-1F1B": 21614,
                "I-1F1B": 25008,
                "ZB": 21316,
                "Mist": 17559,
                "OctoPipe": 15722,
            }
        },
        "Seq_4k": {
            "Small": {
                "S-1F1B": 4820, 
                "I-1F1B": 5125,
                "ZB": 4756,
                "Mist": 4136,
                "OctoPipe": 3831,
            },
            "Medium": {
                "S-1F1B": 11193,
                "I-1F1B": 12810,
                "ZB": 11049,
                "Mist": 9986,
                "OctoPipe": 8088,
            },
            "Large": {
                "S-1F1B": 29007,
                "I-1F1B": 35202,
                "ZB": 28613,
                "Mist": 23700,
                "OctoPipe": 22016,
            }
        },
    }
}

h200_real_data = { # Throughput
    "Nemotron-H": {
        "Seq_2k": {
            "Small": {
                "S-1F1B": 7586,
                "I-1F1B": 7128,
                "ZB": 7355,
                "Mist": 7557,
                "OctoPipe": 8945
            },
            "Medium": {
                "S-1F1B": 3499,
                "I-1F1B": 3109,
                "ZB": 3517,
                "Mist": 4067,
                "OctoPipe": 4943
            },
            "Large": {
                "S-1F1B": 1439,
                "I-1F1B": 1157,
                "ZB": 1403,
                "Mist": 1691,
                "OctoPipe": 1940
            }
        },
        "Seq_4k": {
            "Small": {
                "S-1F1B": 13244,
                "I-1F1B": 12082,
                "ZB": 13040,
                "Mist": 14879,
                "OctoPipe": 16696
            },
            "Medium": {
                "S-1F1B": 5414,
                "I-1F1B": 4502,
                "ZB": 5454,
                "Mist": 5831,
                "OctoPipe": 7381
            },
            "Large": {
                "S-1F1B": 1946,
                "I-1F1B": 1515,
                "ZB": 2014,
                "Mist": 2254,
                "OctoPipe": 2650
            }
        }
    },
}

h200_data = {
    "Gemma": {
        "Seq_2k": {
            "Small": {
                "S-1F1B": 4421,
                "I-1F1B": 4395,
                "ZB": 4368,
                "Mist": 4507,
                "OctoPipe": 5086
            },
            "Medium": {
                "S-1F1B": 1769,
                "I-1F1B": 1745,
                "ZB": 1764,
                "Mist": 2075,
                "OctoPipe": 2320
            },
            "Large": {
                "S-1F1B": 647,
                "I-1F1B": 621,
                "ZB": 667,
                "Mist": 799,
                "OctoPipe": 890
            }
        },
        "Seq_4k": {
            "Small": {
                "S-1F1B": 6209,
                "I-1F1B": 6325,
                "ZB": 6364,
                "Mist": 7048,
                "OctoPipe": 7566
            },
            "Medium": {
                "S-1F1B": 2266,
                "I-1F1B": 2306,
                "ZB": 2343,
                "Mist": 2782,
                "OctoPipe": 3149
            },
            "Large": {
                "S-1F1B": 861,
                "I-1F1B": 731,
                "ZB": 885,
                "Mist": 1093,
                "OctoPipe": 1226
            }
        }
    },
    "DeepSeek": {
        "Seq_2k": {
            "Small": {
                "S-1F1B": 8697,
                "I-1F1B": 8706,
                "ZB": 8856,
                "Mist": 9583,
                "OctoPipe": 11044
            },
            "Medium": {
                "S-1F1B": 3495,
                "I-1F1B": 3399,
                "ZB": 3456,
                "Mist": 3870,
                "OctoPipe": 4730
            },
            "Large": {
                "S-1F1B": 1811,
                "I-1F1B": 1745,
                "ZB": 1847,
                "Mist": 2304,
                "OctoPipe": 2482
            }
        },
        "Seq_4k": {
            "Small": {
                "S-1F1B": 12031,
                "I-1F1B": 12463,
                "ZB": 12152,
                "Mist": 12921,
                "OctoPipe": 15719
            },
            "Medium": {
                "S-1F1B": 4339,
                "I-1F1B": 4534,
                "ZB": 4450,
                "Mist": 5280,
                "OctoPipe": 5935
            },
            "Large": {
                "S-1F1B": 2089,
                "I-1F1B": 2056,
                "ZB": 2133,
                "Mist": 2467,
                "OctoPipe": 2989
            }
        }
    },
    "Nemotron-H": {
        "Seq_2k": {
            "Small": {
                "S-1F1B": 7586,
                "I-1F1B": 7128,
                "ZB": 7355,
                "Mist": 7557,
                "OctoPipe": 8945
            },
            "Medium": {
                "S-1F1B": 3499,
                "I-1F1B": 3109,
                "ZB": 3517,
                "Mist": 4067,
                "OctoPipe": 4943
            },
            "Large": {
                "S-1F1B": 1439,
                "I-1F1B": 1157,
                "ZB": 1403,
                "Mist": 1691,
                "OctoPipe": 1940
            }
        },
        "Seq_4k": {
            "Small": {
                "S-1F1B": 13244,
                "I-1F1B": 12082,
                "ZB": 13040,
                "Mist": 14879,
                "OctoPipe": 16696
            },
            "Medium": {
                "S-1F1B": 5414,
                "I-1F1B": 4502,
                "ZB": 5454,
                "Mist": 5831,
                "OctoPipe": 7381
            },
            "Large": {
                "S-1F1B": 1946,
                "I-1F1B": 1515,
                "ZB": 2014,
                "Mist": 2254,
                "OctoPipe": 2650
            }
        }
    }
}

solving_time = {
    "S":{
        "ILP Solver 1":{
            1 : 0.01,
            2 : 0.01,
            3 : 0.01,
            4 : 0.02,
            5 : 0.05,
            6 : 0.20,
            7 : 0.40,
            8 : 2.31,
            9 : 9.38,
            10 : 23.92,
            11 : 91.12,
            12 : 567.09,
            # 11 : 218.22,
            # 12:708.45,
        },
        "ILP Solver 1+2":{
            1 : 0.03,
            2 : 0.16,
            3 : 0.65,
            4 : 2.49,
            5 : 6.01,
            6 : 16.60,
            7 : 37.38,
            8 : 286.79,
            9 : 655.44,
            10 : 4980.70,
            # 9:1.73,
            # 10:6.51,
            # 11:91.12,
            # 12:708.45,
            # 16:708.45 * 4**4,
            # 32:708.45 * 4**20,
            # 64:708.45 * 4**52,
            # 128:708.45 * 4**116,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 0.01,
            2 : 2.48,
            3 : 25.07,
            4 : 3225.21,
        },
        "OctoPipe 1+2+3":{
            1:0.0027229785919189453,
            2:0.004370212554931641,
            # 3:0.006058931350708008,
            4:0.007737159729003906,
            # 5:0.010064125061035156,
            8:0.016314029693603516,
            # 10:0.021142005920410156,
            # 11:0.02317976951599121,
            # 12:0.02660202980041504,
            16:0.0471949577331543,
            32:0.1510000228881836,
            64:0.5599300861358643,
            128:2.147493839263916,
            256:8.570109844207764,
        },
        "ILP Solver (Simple)":{
            1 : 0.01,
            2 : 0.01,
            3 : 0.01,
            4 : 0.02,
            5 : 0.05,
            6 : 0.20,
            7 : 0.40,
            8 : 2.31,
            9 : 9.38,
            10 : 23.92,
            11 : 91.12,
            12 : 567.09,
        },
        "ILP Solver":{
            1 : 0.03,
            2 : 0.16,
            3 : 0.65,
            4 : 2.49,
            5 : 6.01,
            6 : 16.60,
            7 : 37.38,
            8 : 286.79,
            9 : 655.44,
            10 : 4980.70,
        },
        "OctoPipe":{
            1:0.0027229785919189453,
            2:0.004370212554931641,
            # 3:0.006058931350708008,
            4:0.007737159729003906,
            # 5:0.010064125061035156,
            8:0.016314029693603516,
            # 10:0.021142005920410156,
            # 11:0.02317976951599121,
            # 12:0.02660202980041504,
            16:0.0471949577331543,
            32:0.1510000228881836,
            64:0.5599300861358643,
            128:2.147493839263916,
            256:8.570109844207764,
        }
    },
    "M":{
        "ILP Solver 1":{
            1 : 0.01,
            2 : 0.02,
            3 : 0.03,
            4 : 0.04,
            5 : 0.20,
            6 : 0.39,
            7 : 1.60,
            8 : 3.33,
            9 : 14.37,
            10 : 54.16,
            11 : 139.95,
            12 : 1149.01,
            # 16:708.45 * 8**4,
            # 32:708.45 * 8**20,
            # 64:708.45 * 8**52,
            # 128:708.45 * 8**116,
        },
        "ILP Solver 1+2":{
            1:0.08,
            2:1.74,
            3:13.55,
            4:42.50,
            5:123.28,
            6:334.71,
            7:2570.85,
            # 8:,
            # 9:,
            # 10:,
            # 11:,
            # 12:708.45,
            # 16:708.45 * 4**4,
            # 32:708.45 * 4**20,
            # 64:708.45 * 4**52,
            # 128:708.45 * 4**116,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 0.01,
            2 : 12.48,
            3 : 255.07,
            4 : 33225.21,
        },
        "OctoPipe 1+2+3":{
            1:0.010091066360473633,
            2:0.016767024993896484,
            4:0.030283212661743164,
            8:0.06046891212463379,
            # 12:0.10080623626708984,
            16:0.14447903633117676,
            32:0.46828699111938477,
            64:1.6417560577392578,
            128:6.35432505607605,
            256:24.684877157211304,
        },
        "ILP Solver (Simple)":{
            1 : 0.01,
            2 : 0.02,
            3 : 0.03,
            4 : 0.04,
            5 : 0.20,
            6 : 0.39,
            7 : 1.60,
            8 : 3.33,
            9 : 14.37,
            10 : 54.16,
            11 : 139.95,
            12 : 1149.01,
        },
        "ILP Solver":{
            1:0.08,
            2:1.74,
            3:13.55,
            4:42.50,
            5:123.28,
            6:334.71,
            7:2570.85,
        },
        "OctoPipe":{
            1:0.010091066360473633,
            2:0.016767024993896484,
            4:0.030283212661743164,
            8:0.06046891212463379,
            # 12:0.10080623626708984,
            16:0.14447903633117676,
            32:0.46828699111938477,
            64:1.6417560577392578,
            128:6.35432505607605,
            256:24.684877157211304,
        }
    },
    "L":{
        "ILP Solver 1":{
            1 : 0.02,
            2 : 1.06,
            3 : 4.23,
            4 : 63.23,
        },
        "ILP Solver 1+2":{
            1 : 0.02,
            2 : 6.06,
            3 : 38.23,
            4 : 4559.98,
        },
        "ILP Solver 1+2+3":{ # fake
            1 : 10.01,
            2 : 152.48,
            3 : 1315.07,
            4 : 113211.21,
        },
        "OctoPipe 1+2+3":{
            1 : 0.04270195960998535,
            2 : 0.06787681579589844,
            4 : 0.12933897972106934,
            8 : 0.28123903274536133,
            16 : 0.7080039978027344,
            32 : 2.0303170680999756,
            64 : 6.652433156967163,
            128 : 23.73698091506958,
            256 : 92.29179000854492,
        },
        "ILP Solver (Simple)":{
            1 : 0.02,
            2 : 1.06,
            3 : 4.23,
            4 : 63.23,
        },
        "ILP Solver":{
            1 : 0.02,
            2 : 6.06,
            3 : 38.23,
            4 : 4559.98,
        },
        "OctoPipe":{
            1 : 0.04270195960998535,
            2 : 0.06787681579589844,
            4 : 0.12933897972106934,
            8 : 0.28123903274536133,
            16 : 0.7080039978027344,
            32 : 2.0303170680999756,
            64 : 6.652433156967163,
            128 : 23.73698091506958,
            256 : 92.29179000854492,
        }
    },
}

vary_length_seqence = {
    "1K": {
        "S-1F1B": 676,
        "I-1F1B": 493,
        "ZB": 630,
        "Mist": 632,
        "OctoPipe": 757
    },
    "2K": {
        "S-1F1B": 1253,
        "I-1F1B": 967,
        "ZB": 1261,
        "Mist": 1345,
        "OctoPipe": 1531
    },
    "4K": {
        "S-1F1B": 2244,
        "I-1F1B": 1758,
        "ZB": 2242,
        "Mist": 2487,
        "OctoPipe": 2810
    },
    "8K": {
        "S-1F1B": 3640,
        "I-1F1B": 2800,
        "ZB": 3704,
        "Mist": 4608,
        "OctoPipe": 5592
    },
    "16K": {
        "S-1F1B": 5090,
        "I-1F1B": 4152,
        "ZB": 5179,
        "Mist": 6965,
        "OctoPipe": 7670
    },
    "32K": {
        "S-1F1B": 5428,
        "I-1F1B": 4070,
        "ZB": 5521,
        "Mist": 7353,
        "OctoPipe": 8198
    }
}

strong_scaling_data = {
    # "(8, 8, 1, 1)": {
    "8 GPUs": {
        "S-1F1B": 7340 * 8,
        "I-1F1B": 6968 * 8,
        "ZB": 7567 * 8,
        "Mist": 7813 * 8,
        "OctoPipe": 8977 * 8
    },
    # "(16, 8, 2, 1)": {
    "16 GPUs": {
        "S-1F1B": 6114 * 16,
        "I-1F1B": 4847 * 16,
        "ZB": 6411 * 16,
        "Mist": 6732 * 16,
        "OctoPipe": 8279 * 16
    },
    # "(32, 8, 4, 1)": {
    "32 GPUs": {
        "S-1F1B": 4140 * 32,
        "I-1F1B": 3232 * 32,
        "ZB": 4428 * 32,
        "Mist": 4929 * 32,
        "OctoPipe": 5910 * 32,
    },
    # "(64, 8, 4, 2)": {
    "64 GPUs": {
        "S-1F1B": 4290 * 64,
        "I-1F1B": 2814 * 64,
        "ZB": 4126 * 64,
        "Mist": 4959 * 64,
        "OctoPipe": 6032 * 64,
    },
    # "(128, 8, 4, 4)": {
    "128 GPUs": {
        "S-1F1B": 3588 * 128,
        "I-1F1B": 2750 * 128,
        "ZB": 3763 * 128,
        "Mist": 4443 * 128,
        "OctoPipe": 5264 * 128,
    },
}

weak_scaling_data = {
    # "(8, 8, 1, 1)": {
    "8 GPUs": {
        "S-1F1B": 7333 * 8,
        "I-1F1B": 6558 * 8,
        "ZB": 7388 * 8,
        "Mist": 7743 * 8,
        "OctoPipe": 8921 * 8,
    },
    # "(16, 8, 2, 1)": {
    "16 GPUs": {
        "S-1F1B": 6159 * 16,
        "I-1F1B": 4873 * 16,
        "ZB": 6327 * 16,
        "Mist": 6742 * 16,
        "OctoPipe": 8184 * 16,
    },
    # "(32, 8, 4, 1)": {
    "32 GPUs": {
        "S-1F1B": 4672 * 32,
        "I-1F1B": 3266 * 32,
        "ZB": 4329 * 32,
        "Mist": 5226 * 32,
        "OctoPipe": 6231 * 32,
    },
    # "(64, 8, 4, 2)": {
    "64 GPUs": {
        "S-1F1B": 4138 * 64,
        "I-1F1B": 3108 * 64,
        "ZB": 4351 * 64,
        "Mist": 4830 * 64,
        "OctoPipe": 5787 * 64,
    },
    # "(128, 8, 4, 4)": {
    "128 GPUs": {
        "S-1F1B": 3635 * 128,
        "I-1F1B": 2697 * 128,
        "ZB": 3728 * 128,
        "Mist": 4151 * 128,
        "OctoPipe": 4567 * 128,
    },
}

profiled_data = {
    "GEMMA":{ # Model
        1536:{ # Hidden
            2048:{ # Sequence length
                256000 : [1.0, 1.61, 0.2, 0.0, 0.0, 0.0, 4.17, 0.65, 0.4],
                512000 : [1.0, 1.64, 0.2, 0.0, 0.0, 0.0, 7.23, 1.6, 0.82],
                1024000 : [1.0, 1.65, 0.2, 0.0, 0.0, 0.0, 12.81, 3.64, 1.59],
            },
            4096:{
                256000 : [1.0, 1.65, 0.22, 0.0, 0.0, 0.0, 5.72, 1.21, 0.58],
                512000 : [1.0, 1.65, 0.22, 0.0, 0.0, 0.0, 10.37, 2.85, 1.15],
                1024000 : [1.0, 1.67, 0.22, 0.0, 0.0, 0.0, 19.22, 5.93, 2.29],
            },
            8192:{
                256000 : [1.0, 1.68, 0.22, 0.0, 0.0, 0.0, 6.98, 1.68, 0.77],
                512000 : [1.0, 1.69, 0.22, 0.0, 0.0, 0.0, 13.24, 4.05, 1.51],
                1024000 : [1.0, 1.69, 0.22, 0.0, 0.0, 0.0, 25.97, 8.69, 3.06],
            }
        }
    },
    "DEEPSEEK":{ # Model
        2048:{ # Hidden
            2048:{ # Sequence length
                131072 : [1.0, 1.99, 0.0, 2.62, 3.87, 0.17, 5.11, 1.37, 0.62],
                262144 : [1.0, 2.1, 0.0, 2.69, 4.0, 0.18, 8.91, 3.0, 1.27],
                524288 : [1.0, 2.28, 0.0, 2.72, 4.04, 0.18, 16.31, 5.56, 2.54],
            },
            4096:{
                131072 : [1.0, 2.05, 0.0, 2.28, 3.49, 0.16, 6.26, 1.98, 0.82],
                262144 : [1.0, 2.11, 0.0, 2.29, 3.52, 0.17, 11.2, 3.73, 1.59],
                524288 : [1.0, 2.24, 0.0, 2.31, 3.55, 0.17, 21.57, 7.82, 3.23],
            },
            8192:{
                131072 : [1.0, 2.1, 0.0, 1.93, 3.08, 0.15, 6.99, 2.4, 0.98],
                262144 : [1.0, 2.13, 0.0, 1.91, 3.03, 0.15, 13.14, 4.98, 1.95],
                524288 : [1.0, 2.22, 0.0, 1.93, 3.05, 0.15, 26.22, 10.21, 3.98],
            }
        }
    },
    "NEMOTRONH":{ # Model
        1024:{ # Hidden
            1024:{ # Sequence length
                131072 : [3.17, 5.17, 0.5, 1.0, 2.54, 0.02, 8.23, 0.12, 0.4],
                262144 : [2.69, 4.45, 0.43, 1.0, 2.46, 0.02, 10.01, 1.28, 0.63],
                524288 : [3.38, 5.32, 0.52, 1.0, 2.75, 0.02, 17.1, 2.82, 1.38],
            },
            2048:{
                131072 : [3.38, 5.18, 0.53, 1.0, 2.75, 0.02, 10.81, 0.9, 0.57],
                262144 : [2.79, 4.45, 0.46, 1.0, 2.53, 0.02, 13.92, 2.22, 0.95],
                524288 : [3.06, 4.99, 0.5, 1.0, 2.53, 0.02, 24.37, 5.4, 1.96],
            },
            4096:{
                131072 : [3.12, 4.96, 0.52, 1.0, 2.79, 0.02, 13.99, 2.13, 0.86],
                262144 : [3.22, 5.07, 0.54, 1.0, 2.85, 0.02, 23.94, 5.24, 1.71],
                524288 : [3.06, 4.96, 0.53, 1.0, 2.7, 0.02, 39.97, 10.33, 3.18],
            },
            8192:{
                131072 : [3.14, 5.26, 0.54, 1.0, 2.85, 0.02, 19.38, 3.53, 1.33],
                262144 : [3.15, 5.32, 0.55, 1.0, 2.8, 0.01, 35.93, 9.04, 2.72],
                524288 : [3.17, 5.2, 0.55, 1.0, 2.95, 0.02, 66.15, 18.69, 5.3],
            },
            16384:{
                131072 : [4.74, 7.84, 0.75, 1.0, 3.54, 0.02, 32.48, 6.14, 2.27],
                262144 : [3.95, 7.21, 0.68, 1.0, 3.03, 0.01, 55.09, 14.06, 4.07],
                524288 : [3.53, 6.23, 0.61, 1.0, 3.1, 0.02, 97.43, 29.09, 7.8],
            },
            32768:{
                131072 : [4.81, 9.94, 0.65, 1.0, 2.91, 0.01, 35.18, 4.34, 2.54],
                262144 : [4.93, 9.84, 0.66, 1.0, 3.09, 0.0, 68.75, 15.87, 5.23],
                524288 : [4.79, 9.49, 0.65, 1.0, 3.25, 0.01, 369.05, 37.76, 10.86],
            },
        }
    },
}